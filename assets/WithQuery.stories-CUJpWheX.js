import{bp as S,j as m}from"./index-0nDB5Zzz.js";import{r as g}from"./index-CBqU2yxZ.js";import{O as P}from"./Output-Sfj1QWTd.js";import{g as D}from"./generateStoryDecorator-jcZX8bPx.js";import"./_baseClone-CBkhujLI.js";import"./isPlainObject-Dl0da9pc.js";import"./_commonjsHelpers-BosuxZz1.js";import"./mapValues-CZXAhdHD.js";import"./index-Ch9hqOxJ.js";import"./toNumber-BGTiNFDU.js";import"./StoryBox-BZYZ6up0.js";import"./fr_FR-CrxT__co.js";class T extends Error{constructor(e,n,t){const s=e.status||e.status===0?e.status:"",o=e.statusText||"",i=`${s} ${o}`.trim(),a=i?`status code ${i}`:"an unknown error";super(`Request failed with ${a}`),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="HTTPError",this.response=e,this.request=n,this.options=t}}class x extends Error{constructor(e){super("Request timed out"),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.request=e}}const h=r=>r!==null&&typeof r=="object",c=(...r)=>{for(const e of r)if((!h(e)||Array.isArray(e))&&typeof e<"u")throw new TypeError("The `options` argument must be an object");return w({},...r)},C=(r={},e={})=>{const n=new globalThis.Headers(r),t=e instanceof globalThis.Headers,s=new globalThis.Headers(e);for(const[o,i]of s.entries())t&&i==="undefined"||i===void 0?n.delete(o):n.set(o,i);return n},w=(...r)=>{let e={},n={};for(const t of r)if(Array.isArray(t))Array.isArray(e)||(e=[]),e=[...e,...t];else if(h(t)){for(let[s,o]of Object.entries(t))h(o)&&s in e&&(o=w(e[s],o)),e={...e,[s]:o};h(t.headers)&&(n=C(n,t.headers),e.headers=n)}return e},V=(()=>{let r=!1,e=!1;const n=typeof globalThis.ReadableStream=="function",t=typeof globalThis.Request=="function";return n&&t&&(e=new globalThis.Request("https://a.com",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type")),r&&!e})(),j=typeof globalThis.AbortController=="function",I=typeof globalThis.ReadableStream=="function",L=typeof globalThis.FormData=="function",E=["get","post","put","patch","head","delete"],M={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},b=2147483647,k=Symbol("stop"),F=r=>E.includes(r)?r.toUpperCase():r,H=["get","put","head","delete","options","trace"],U=[408,413,429,500,502,503,504],A=[413,429,503],_={limit:2,methods:H,statusCodes:U,afterStatusCodes:A,maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY},N=(r={})=>{if(typeof r=="number")return{..._,limit:r};if(r.methods&&!Array.isArray(r.methods))throw new Error("retry.methods must be an array");if(r.statusCodes&&!Array.isArray(r.statusCodes))throw new Error("retry.statusCodes must be an array");return{..._,...r,afterStatusCodes:A}};async function B(r,e,n){return new Promise((t,s)=>{const o=setTimeout(()=>{e&&e.abort(),s(new x(r))},n.timeout);n.fetch(r).then(t).catch(s).then(()=>{clearTimeout(o)})})}const Q=!!globalThis.DOMException;function v(r){if(Q)return new DOMException((r==null?void 0:r.reason)??"The operation was aborted.","AbortError");const e=new Error((r==null?void 0:r.reason)??"The operation was aborted.");return e.name="AbortError",e}async function $(r,{signal:e}){return new Promise((n,t)=>{if(e){if(e.aborted){t(v(e));return}e.addEventListener("abort",s,{once:!0})}function s(){t(v(e)),clearTimeout(o)}const o=setTimeout(()=>{e==null||e.removeEventListener("abort",s),n()},r)})}class f{static create(e,n){const t=new f(e,n),s=async()=>{if(t._options.timeout>b)throw new RangeError(`The \`timeout\` option cannot be greater than ${b}`);await Promise.resolve();let a=await t._fetch();for(const u of t._options.hooks.afterResponse){const l=await u(t.request,t._options,t._decorateResponse(a.clone()));l instanceof globalThis.Response&&(a=l)}if(t._decorateResponse(a),!a.ok&&t._options.throwHttpErrors){let u=new T(a,t.request,t._options);for(const l of t._options.hooks.beforeError)u=await l(u);throw u}if(t._options.onDownloadProgress){if(typeof t._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!I)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return t._stream(a.clone(),t._options.onDownloadProgress)}return a},i=t._options.retry.methods.includes(t.request.method.toLowerCase())?t._retry(s):s();for(const[a,u]of Object.entries(M))i[a]=async()=>{t.request.headers.set("accept",t.request.headers.get("accept")||u);const d=(await i).clone();if(a==="json"){if(d.status===204||(await d.clone().arrayBuffer()).byteLength===0)return"";if(n.parseJson)return n.parseJson(await d.text())}return d[a]()};return i}constructor(e,n={}){if(Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"abortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_retryCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._input=e,this._options={credentials:this._input.credentials||"same-origin",...n,headers:C(this._input.headers,n.headers),hooks:w({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},n.hooks),method:F(n.method??this._input.method),prefixUrl:String(n.prefixUrl||""),retry:N(n.retry),throwHttpErrors:n.throwHttpErrors!==!1,timeout:typeof n.timeout>"u"?1e4:n.timeout,fetch:n.fetch??globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(j){if(this.abortController=new globalThis.AbortController,this._options.signal){const t=this._options.signal;this._options.signal.addEventListener("abort",()=>{this.abortController.abort(t.reason)})}this._options.signal=this.abortController.signal}if(V&&(this._options.duplex="half"),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const s="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),o=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,s);(L&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(o,{...this.request}),this._options)}this._options.json!==void 0&&(this._options.body=JSON.stringify(this._options.json),this.request.headers.set("content-type",this._options.headers.get("content-type")??"application/json"),this.request=new globalThis.Request(this.request,{body:this._options.body}))}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<this._options.retry.limit&&!(e instanceof x)){if(e instanceof T){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;const t=e.response.headers.get("Retry-After");if(t&&this._options.retry.afterStatusCodes.includes(e.response.status)){let s=Number(t);return Number.isNaN(s)?s=Date.parse(t)-Date.now():s*=1e3,typeof this._options.retry.maxRetryAfter<"u"&&s>this._options.retry.maxRetryAfter?0:s}if(e.response.status===413)return 0}return Math.min(this._options.retry.backoffLimit,.3*2**(this._retryCount-1)*1e3)}return 0}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(n){const t=Math.min(this._calculateRetryDelay(n),b);if(t!==0&&this._retryCount>0){await $(t,{signal:this._options.signal});for(const s of this._options.hooks.beforeRetry)if(await s({request:this.request,options:this._options,error:n,retryCount:this._retryCount})===k)return;return this._retry(e)}throw n}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const n=await e(this.request,this._options);if(n instanceof Request){this.request=n;break}if(n instanceof Response)return n}return this._options.timeout===!1?this._options.fetch(this.request.clone()):B(this.request.clone(),this.abortController,this._options)}_stream(e,n){const t=Number(e.headers.get("content-length"))||0;let s=0;return e.status===204?(n&&n({percent:1,totalBytes:t,transferredBytes:s},new Uint8Array),new globalThis.Response(null,{status:e.status,statusText:e.statusText,headers:e.headers})):new globalThis.Response(new globalThis.ReadableStream({async start(o){const i=e.body.getReader();n&&n({percent:0,transferredBytes:0,totalBytes:t},new Uint8Array);async function a(){const{done:u,value:l}=await i.read();if(u){o.close();return}if(n){s+=l.byteLength;const d=t===0?0:s/t;n({percent:d,transferredBytes:s,totalBytes:t},l)}o.enqueue(l),await a()}await a()}}),{status:e.status,statusText:e.statusText,headers:e.headers})}}/*! MIT License © Sindre Sorhus */const y=r=>{const e=(n,t)=>f.create(n,c(r,t));for(const n of E)e[n]=(t,s)=>f.create(t,c(r,s,{method:n}));return e.create=n=>y(c(n)),e.extend=n=>y(c(r,n)),e.stop=k,e},W=y(),J={error:"",isLabelHidden:!1,isLight:!1,label:"An autocompletable select",name:"autoComplete",placeholder:'Type "brew"'},ue={title:"Fields/Search (variations)",component:S,argTypes:{},args:J,decorators:[D({withBackgroundButton:!0})]};function p(r){const[e,n]=g.useState("∅"),[t,s]=g.useState([]),o=async i=>{const a=await W.get(`https://api.openbrewerydb.org/breweries?by_name=${i}`).json(),u=a?a.map(({id:l,name:d})=>({label:d,value:l})):[];s(u)};return m.jsxs(m.Fragment,{children:[m.jsx(S,{...r,onChange:n,onQuery:o,options:t}),e!=="∅"&&m.jsx(P,{value:e})]})}p.__docgenInfo={description:"",methods:[],displayName:"WithQuery",props:{MenuItem:{required:!1,tsType:{name:"union",raw:"ElementType | undefined",elements:[{name:"ElementType"},{name:"undefined"}]},description:""},baseContainer:{required:!1,tsType:{name:"union",raw:"Document | HTMLDivElement | null | undefined",elements:[{name:"Document"},{name:"HTMLDivElement"},{name:"null"},{name:"undefined"}]},description:"Used to pass something else than `window.document` as a base container to attach global events listeners."},customSearch:{required:!1,tsType:{name:"union",raw:"CustomSearch<Option<OptionValue>> | undefined",elements:[{name:"CustomSearch",elements:[{name:"intersection",raw:`Omit<
  ItemDataType<string>,
  'children' | 'label' | 'value'
> & {
  children?: never
  isDisabled?: boolean
  label: string
  value: OptionValue
}`,elements:[{name:"Omit",elements:[{name:"ItemDataType",elements:[{name:"string"}],raw:"ItemDataType<string>"},{name:"union",raw:"'children' | 'label' | 'value'",elements:[{name:"literal",value:"'children'"},{name:"literal",value:"'label'"},{name:"literal",value:"'value'"}]}],raw:`Omit<
  ItemDataType<string>,
  'children' | 'label' | 'value'
>`},{name:"signature",type:"object",raw:`{
  children?: never
  isDisabled?: boolean
  label: string
  value: OptionValue
}`,signature:{properties:[{key:"children",value:{name:"never",required:!1}},{key:"isDisabled",value:{name:"boolean",required:!1}},{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"OptionValue",required:!0}}]}}]}],raw:"CustomSearch<Option<OptionValue>>"},{name:"undefined"}]},description:""},customSearchMinQueryLength:{required:!1,tsType:{name:"union",raw:"number | undefined",elements:[{name:"number"},{name:"undefined"}]},description:"Minimum search query length required to trigger custom search filtering."},disabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},error:{required:!1,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},isErrorMessageHidden:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},isLabelHidden:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},isLight:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},isSearchIconHidden:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},isTransparent:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},isUndefinedWhenDisabled:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},label:{required:!0,tsType:{name:"string"},description:""},name:{required:!0,tsType:{name:"string"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(nextValue: OptionValue | undefined) => Promisable<void>",signature:{arguments:[{type:{name:"union",raw:"OptionValue | undefined",elements:[{name:"OptionValue"},{name:"undefined"}]},name:"nextValue"}],return:{name:"Promisable",elements:[{name:"void"}],raw:"Promisable<void>"}}},description:""},onQuery:{required:!1,tsType:{name:"signature",type:"function",raw:"(nextQuery: string | undefined) => Promisable<void>",signature:{arguments:[{type:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},name:"nextQuery"}],return:{name:"Promisable",elements:[{name:"void"}],raw:"Promisable<void>"}}},description:""},optionValueKey:{required:!1,tsType:{name:"union",raw:"keyof OptionValue | undefined",elements:[{name:"OptionValue"},{name:"undefined"}]},description:""},options:{required:!1,tsType:{name:"Array",elements:[{name:"intersection",raw:`Omit<
  ItemDataType<string>,
  'children' | 'label' | 'value'
> & {
  children?: never
  isDisabled?: boolean
  label: string
  value: OptionValue
}`,elements:[{name:"Omit",elements:[{name:"ItemDataType",elements:[{name:"string"}],raw:"ItemDataType<string>"},{name:"union",raw:"'children' | 'label' | 'value'",elements:[{name:"literal",value:"'children'"},{name:"literal",value:"'label'"},{name:"literal",value:"'value'"}]}],raw:`Omit<
  ItemDataType<string>,
  'children' | 'label' | 'value'
>`},{name:"signature",type:"object",raw:`{
  children?: never
  isDisabled?: boolean
  label: string
  value: OptionValue
}`,signature:{properties:[{key:"children",value:{name:"never",required:!1}},{key:"isDisabled",value:{name:"boolean",required:!1}},{key:"label",value:{name:"string",required:!0}},{key:"value",value:{name:"OptionValue",required:!0}}]}}]}],raw:"Option<OptionValue>[]"},description:""},readOnly:{required:!1,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},value:{required:!1,tsType:{name:"union",raw:"OptionValue | undefined",elements:[{name:"OptionValue"},{name:"undefined"}]},description:""}}};var q,O,R;p.parameters={...p.parameters,docs:{...(q=p.parameters)==null?void 0:q.docs,source:{originalSource:`function WithQuery(props: SearchProps) {
  const [outputValue, setOutputValue] = useState<any | undefined | '∅'>('∅');
  const [options, setOptions] = useState<{
    label: any;
    value: any;
  }[]>([]);
  const onQuery = async value => {
    const results: Record<string, any>[] = await ky.get(\`https://api.openbrewerydb.org/breweries?by_name=\${value}\`).json();
    const dataFormatted = results ? results.map(({
      id,
      name
    }) => ({
      label: name,
      value: id
    })) : [];
    setOptions(dataFormatted);
  };
  return <>
      <Search {...props} onChange={setOutputValue} onQuery={onQuery} options={options} />

      {outputValue !== '∅' && <Output value={outputValue} />}
    </>;
}`,...(R=(O=p.parameters)==null?void 0:O.docs)==null?void 0:R.source}}};const le=["WithQuery"];export{p as WithQuery,le as __namedExportsOrder,ue as default};
